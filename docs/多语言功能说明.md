# Smart Tab Manager 多语言功能说明

## 🌐 功能概述

Smart Tab Manager 现已支持完整的多语言功能，包括中文和英文两种语言。用户可以通过多种方式切换语言，实现无缝的国际化体验。

## ✨ 功能特性

### 1. 支持的语言
- **中文 (zh-CN)** - 简体中文
- **English (en-US)** - 英语

### 2. 语言切换方式
1. **快速切换按钮**: 在主界面右上角点击地球图标
2. **设置页面**: 在扩展设置 → 常规设置 → 语言选项
3. **自动保存**: 语言设置会自动保存并在重启后恢复

### 3. 多语言覆盖范围
- ✅ 主界面 (PopupApp.vue)
- ✅ 设置页面 (OptionsApp.vue)  
- ✅ 通知消息
- ✅ 重复检测对话框
- ✅ 时间格式化
- ✅ 错误提示

## 🛠️ 技术实现

### 架构设计
```
src/utils/i18n.ts           # 多语言核心工具
├── messages                # 翻译文本定义
├── useI18n()              # Vue Composition API
├── currentLanguage        # 当前语言状态  
└── 自动保存到设置          # 持久化存储
```

### 核心API

#### useI18n() 函数
```typescript
const { t, currentLanguage, toggleLanguage, initLanguage } = useI18n()

// 获取翻译文本
t('popup.overview.title')        // "概览" 或 "Overview"

// 切换语言 (中文 ↔ 英文)
await toggleLanguage()

// 设置特定语言
await setLanguage('en-US')

// 初始化语言 (从设置加载)
await initLanguage()
```

## 📁 翻译文本结构

```typescript
{
  'zh-CN': {
    common: {           // 通用文本
      save: '保存',
      cancel: '取消'
    },
    popup: {            // 主界面
      title: 'Smart Tab Manager',
      search: {
        placeholder: '搜索或输入命令...'
      },
      overview: {       // 概览部分
        title: '概览',
        totalTabs: '个标签页'
      }
    },
    options: {          // 设置页面
      general: {
        theme: '主题'
      }
    },
    notifications: {    // 通知消息
      languageChanged: '语言已切换'
    }
  },
  'en-US': {
    // 对应的英文翻译...
  }
}
```

## 🎯 使用示例

### 1. 在 Vue 组件中使用

```vue
<template>
  <div>
    <!-- 直接使用翻译函数 -->
    <h1>{{ t('popup.title') }}</h1>
    
    <!-- 在属性中使用 -->
    <input :placeholder="t('popup.search.placeholder')" />
    
    <!-- 语言切换按钮 -->
    <button @click="handleLanguageToggle">
      {{ currentLanguage === 'zh-CN' ? 'EN' : '中' }}
    </button>
  </div>
</template>

<script setup>
import { useI18n } from '@/utils/i18n'

const { t, currentLanguage, toggleLanguage } = useI18n()

async function handleLanguageToggle() {
  await toggleLanguage()
  // 显示切换成功通知
}
</script>
```

### 2. 在 JavaScript 中使用

```typescript
import { useI18n } from '@/utils/i18n'

const { t } = useI18n()

// 显示通知
showNotification('success', t('notifications.settingsSaved'))

// 错误处理
throw new Error(t('common.error'))
```

## 🔧 添加新的翻译

### 1. 在 i18n.ts 中添加新的翻译键

```typescript
export const messages = {
  'zh-CN': {
    popup: {
      newFeature: {
        title: '新功能',
        description: '这是一个新功能的描述'
      }
    }
  },
  'en-US': {
    popup: {
      newFeature: {
        title: 'New Feature',
        description: 'This is a description of the new feature'
      }
    }
  }
}
```

### 2. 在组件中使用

```vue
<template>
  <div>
    <h2>{{ t('popup.newFeature.title') }}</h2>
    <p>{{ t('popup.newFeature.description') }}</p>
  </div>
</template>
```

## 🚀 快速开始

### 1. 语言切换体验

1. 打开浏览器扩展
2. 点击右上角的地球图标 🌐
3. 观察界面语言的即时切换
4. 重新打开扩展，语言设置已保存

### 2. 设置页面语言配置

1. 右键扩展图标 → 选项
2. 常规设置 → 语言
3. 选择所需语言
4. 设置自动保存并生效

## 🎨 UI/UX 设计

### 语言切换按钮设计
- **位置**: 主界面右上角，设置按钮旁边
- **图标**: 地球图标 (GlobeAltIcon)
- **文本**: 显示切换目标语言 ("EN" 或 "中")
- **交互**: 悬停效果、点击反馈
- **动画**: 平滑的颜色过渡

### 视觉反馈
- ✅ 切换成功通知
- ✅ 悬停高亮效果  
- ✅ 当前语言指示
- ✅ 无缝界面更新

## 🔄 自动化功能

### 1. 语言检测与恢复
- 启动时自动加载保存的语言设置
- 异常情况下降级到默认语言 (中文)
- 设置变化时实时响应

### 2. 持久化存储
- 语言设置保存到 `chrome.storage.sync`
- 与其他设置项同步更新
- 跨设备同步支持

## 🐛 故障排除

### 常见问题

1. **语言切换不生效**
   - 检查浏览器控制台是否有错误
   - 确认存储权限正常
   - 重新加载扩展

2. **翻译文本显示键名**
   - 检查翻译键是否存在
   - 确认 i18n.ts 中的文本定义正确
   - 查看控制台警告信息

3. **设置不保存**
   - 检查 chrome.storage 权限
   - 确认设置页面正常工作
   - 尝试手动保存设置

### 调试方法

```javascript
// 在浏览器控制台中调试
const { currentLanguage, t } = useI18n()
console.log('当前语言:', currentLanguage.value)
console.log('翻译测试:', t('popup.title'))
```

## 🔮 未来扩展

### 计划支持的语言
- 🇯🇵 日语 (ja-JP)
- 🇰🇷 韩语 (ko-KR) 
- 🇫🇷 法语 (fr-FR)
- 🇩🇪 德语 (de-DE)
- 🇪🇸 西班牙语 (es-ES)

### 功能增强
- [ ] 自动语言检测 (基于浏览器设置)
- [ ] 区域化数字和日期格式
- [ ] 右到左文字支持 (RTL)
- [ ] 语言包动态加载
- [ ] 翻译质量反馈系统

## 📝 开发规范

### 命名约定
- 翻译键使用 `.` 分隔的层级结构
- 组件级翻译以组件名开头 (`popup.`, `options.`)
- 通用翻译使用 `common.` 前缀

### 代码风格
```typescript
// ✅ 推荐
t('popup.overview.totalTabs')

// ❌ 不推荐  
t('popupOverviewTotalTabs')
```

### 翻译更新流程
1. 在 `messages` 对象中添加新的翻译
2. 同时更新所有语言版本
3. 在组件中使用 `t()` 函数
4. 测试语言切换功能
5. 更新文档

---

🎉 **恭喜！** Smart Tab Manager 现已完全支持多语言功能，为全球用户提供本地化体验！ 